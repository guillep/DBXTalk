<!DOCTYPE html>
<html lang="en">
  <head profile="http://www.w3.org/2005/10/profile">
	<link rel="icon" 
      type="image/png" 
      href="/DBXTalk/images/favicon.png">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
	
    <title>Garage</title>
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="/DBXTalk/stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="/DBXTalk/stylesheets/pygment_trac.css" media="screen">
    <link rel="stylesheet" type="text/css" href="/DBXTalk/stylesheets/print.css" media="print">
	<script src="/DBXTalk/highlight/highlight.pack.js"></script>
	<!-- Latest compiled and minified CSS -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
	<style>
	/* Sticky footer styles
	-------------------------------------------------- */
	html {
	  position: relative;
	  min-height: 100%;
	}
	body {
	  /* Margin bottom by footer height */
	  margin-bottom: 60px;
	}
	.footer {
	  position: absolute;
	  bottom: 3px;
	  width: 100%;
	  /* Set the fixed height of the footer here */
	  height: 60px;
	}


	/* Custom page CSS
	-------------------------------------------------- */
	/* Not required for template or sticky footer method. */

	body > .container {
	  padding: 60px 15px 0;
	}
	.container .text-muted {
	  margin: 20px 0;
	}

	.footer > .container {
	  padding-right: 15px;
	  padding-left: 15px;
	}

	code {
	  font-size: 80%;
	}
	
	</style>
	<style>
	/*** Custom Navigation Bar Style
	**** Autogenerated
	****
	***/
	/*Generated from: http://work.smarchal.com/twbscolor/css/9787ef715beaecf0f1ecdbff0*/
	.navbar-default {
	  background-color: #9787ef;
	  border-color: #715bea;
	}
	.navbar-default .navbar-brand {
	  color: #ecf0f1;
	}
	.navbar-default .navbar-brand:hover, .navbar-default .navbar-brand:focus {
	  color: #ecdbff;
	}
	.navbar-default .navbar-text {
	  color: #ecf0f1;
	}
	.navbar-default .navbar-nav > li > a {
	  color: #ecf0f1;
	}
	.navbar-default .navbar-nav > li > a:hover, .navbar-default .navbar-nav > li > a:focus {
	  color: #ecdbff;
	}
	.navbar-default .navbar-nav > .active > a, .navbar-default .navbar-nav > .active > a:hover, .navbar-default .navbar-nav > .active > a:focus {
	  color: #ecdbff;
	  background-color: #715bea;
	}
	.navbar-default .navbar-nav > .open > a, .navbar-default .navbar-nav > .open > a:hover, .navbar-default .navbar-nav > .open > a:focus {
	  color: #ecdbff;
	  background-color: #715bea;
	}
	.navbar-default .navbar-toggle {
	  border-color: #715bea;
	}
	.navbar-default .navbar-toggle:hover, .navbar-default .navbar-toggle:focus {
	  background-color: #715bea;
	}
	.navbar-default .navbar-toggle .icon-bar {
	  background-color: #ecf0f1;
	}
	.navbar-default .navbar-collapse,
	.navbar-default .navbar-form {
	  border-color: #ecf0f1;
	}
	.navbar-default .navbar-link {
	  color: #ecf0f1;
	}
	.navbar-default .navbar-link:hover {
	  color: #ecdbff;
	}

	@media (max-width: 767px) {
	  .navbar-default .navbar-nav .open .dropdown-menu > li > a {
	    color: #ecf0f1;
	  }
	  .navbar-default .navbar-nav .open .dropdown-menu > li > a:hover, .navbar-default .navbar-nav .open .dropdown-menu > li > a:focus {
	    color: #ecdbff;
	  }
	  .navbar-default .navbar-nav .open .dropdown-menu > .active > a, .navbar-default .navbar-nav .open .dropdown-menu > .active > a:hover, .navbar-default .navbar-nav .open .dropdown-menu > .active > a:focus {
	    color: #ecdbff;
	    background-color: #715bea;
	  }
	}
	</style>
  </head>
  
  <body style="padding-top:150px">
    <div class="container-fluid">
    	<div class="inner">
			<nav class="navbar navbar-default navbar-fixed-top">
			
	 		<header style="padding:10px;background-color:white;">
				<div style="width:700px;margin:0 auto;">
					<a href="/DBXTalk/" role="button">
			 			<img alt="dbxtalk" src="/DBXTalk/images/dbxtalk.png" style="height:100px;float:left;margin-right:10px">
					</a>
					<h1>dbxtalk</h1>
		 			<h2 style="margin:0px;">Pharo's relational database suite</h2>
				</div>
	 		</header>
			<div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1" style="width:700px;margin:0 auto;">
				  <ul class="nav navbar-nav">
					
					<li role="presentation" id="Home" >
						<a href="/DBXTalk/index.html" 
							>
							Home
							
						</a>
						
					</li>
					
					<li role="presentation" id="Garage" class="dropdown">
						<a href="" 
							class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
							Garage
							<span class="caret"></span>
						</a>
						
						<ul class="dropdown-menu" role="menu">
							
							<li role="presentation"><a href="/DBXTalk/garage/index.html">Overview</a></li>
							
							<li role="presentation"><a href="/DBXTalk/garage/installation.html">Installation</a></li>
							
							<li role="presentation"><a href="/DBXTalk/garage/getting_started.html">Getting Started</a></li>
							
							<li role="presentation"><a href="/DBXTalk/garage/drivers.html">Supported Drivers</a></li>
							
							<li role="presentation"><a href="/DBXTalk/garage/documentation.html">Documentation</a></li>
							
						</ul>
						
					</li>
					
					<li role="presentation" id="Glorp" >
						<a href="/DBXTalk/glorp.html" 
							>
							Glorp
							
						</a>
						
					</li>
					
					<li role="presentation" id="Contribute" >
						<a href="/DBXTalk/contribute.html" 
							>
							Contribute
							
						</a>
						
					</li>
					
					<li role="presentation" id="Contact" >
						<a href="/DBXTalk/contact.html" 
							>
							Contact
							
						</a>
						
					</li>
					
					</ul>
				</div>
			</nav>
        <hr>

        <section id="main_content">
      	
<h3>Cursored Fetches</h3>
<p>Some Garage drivers supports cursored fetches from the database. That is, they will retrieve the results of a query in chunks of rows instead of reading all of them at once. This ability is important when we work with big amounts of data. Using cursored fetches will limit the amount of memory used and will allow us to manage the network throughput.</p>
<p>Notice that not all Garage drivers support this feature. You can ask a connection if it supports cursored fetches by sending it the <strong>supportsCursoredFetch</strong> message. Take into account that a driver that does not support cursored fetches will fail will an exception when trying to do so.</p>
<p><figure><pre><code class="Smalltalk">connection supportsCursoredFetch.</code></pre><figcaption></figcaption></figure></p>
<p>Cursored fetches can be configured in a per-statement basis, by specifying the <strong>fetchSize:</strong>. Then a statement can be executed as usual using the <strong>execute</strong> message, which will retrieve a result set object as a normal statement.</p>
<p><figure><pre><code class="Smalltalk">statement := connnection createStatement: 'SELECT code, name, observations FROM signature'.

&quot;We fetch 20 rows at a time&quot;
statement fetchSize: 20.

resultSet := statement execute.</code></pre><figcaption></figcaption></figure></p>
<p>A result set created with a fetch size will retrieve <u>N</u> rows lazily, where <u>N</u> is the fetch size. If we ask for <u>N</u> rows to the result set it will do only one round trip to the database. If we ask for <u>N + 1</u> it will do two roundtrips, and bring <u>2 * N</u> rows. It we ask for all the rows of the resultset with the <strong>rows</strong> message, it will perform as many roundtrips it needs to bring all the rows in packs of <u>N</u>, so this feature should be used carefully. The best way to use this cursored fetches is through the result set read stream.</p>
<p><figure><pre><code class="Smalltalk">&quot;We fetch 20 rows at a time&quot;
statement fetchSize: 20.

resultSet := statement execute.
readStream := resultSet readStream.

readStream next: 20. &quot;will perform one trip&quot;

readStream next: 21. &quot;will perform two trips&quot;
readStream next: 40. &quot;will perform two trips also&quot;


readStream next: 5; next:5; next: 10. &quot;will perform only one trip to bring the 20 rows&quot;</code></pre><figcaption></figcaption></figure></p>

<h3>Driver subtleties</h3>
<p>Garage provides only a common interface to perform cursored fetches. Each driver will implement its own features differently. In this section we discuss what is the expected behavior of the exceptional cases.</p>
<p>Drivers that not supporting cursored fetches will fail with an exception at the moment of configuring the fetch size.</p>
<p><figure><pre><code class="Smalltalk">statement fetchSize: 20.
	&quot;=&gt; Exception!&quot;</code></pre><figcaption></figcaption></figure></p>
<p>Some Garage drivers, such as the Postgresql one, requires to perform cursored fetches in a transaction. In such case, a transaction should be created before the execution of the statement.</p>
<p><figure><pre><code class="Smalltalk">connection beginTransaction.
connection createStatement: '...'.
statement fetchSize: 20.
result := statement execute.</code></pre><figcaption></figcaption></figure></p>
      	</section>
		<footer class="footer">
          This website is developed using <a href="https://github.com/pillar-markup/pillar-documentation">Pillar</a><br>
          Theme based on tactile theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.
        </footer>
      </div>
    </div>

	<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
	<!-- Latest compiled and minified JavaScript -->
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
    <script>
	hljs.initHighlightingOnLoad();
	$("#Garage").addClass('active');
	function transformAnnotatedParagraphs(pClass) {
	    $("p." + pClass).wrap("<div class='alert alert-" + pClass + "' role='alert'/>" );
	};
	transformAnnotatedParagraphs('success');
	transformAnnotatedParagraphs('info');
	transformAnnotatedParagraphs('warning');
	transformAnnotatedParagraphs('danger');
	</script>
    
  </body>
</html>
